requires:
  features:
    - HAVE_LIBJANSSON
    - IPFire Location

checks:

  # Check that we only have four events in eve.
  - filter:
      count: 4
      match:
        event_type: alert

  # Check if the geoip keyword workded.
  - filter:
      count: 1
      match:
        event_type: alert
        alert.signature_id: 2

  # Check if the anycast keyword worked.
  - filter:
      count: 1
      match:
        event_type: alert
        alert.signature_id: 3

  # Check if the anonymous-proxy keyword worked.
  - filter:
      count: 1
      match:
          event_type: alert
          alert.signature_id: 4

  # Check if the satellite-provider keyworkd worked.
  - filter:
      count: 1
      match:
          event_type: alert
          alert.signature_id: 5
